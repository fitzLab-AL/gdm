<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Assess Predictor Importance and Quantify Model Significance in a Fitted Generalized Dissimilarity Model. — gdm.varImp • gdm</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Assess Predictor Importance and Quantify Model Significance in a Fitted Generalized Dissimilarity Model. — gdm.varImp"><meta name="description" content="This function uses matrix permutation to perform model and
predictor significance testing and to estimate predictor importance in a
generalized dissimilarity model. The function can be run in parallel on
multicore machines to reduce computation time."><meta property="og:description" content="This function uses matrix permutation to perform model and
predictor significance testing and to estimate predictor importance in a
generalized dissimilarity model. The function can be run in parallel on
multicore machines to reduce computation time."><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-44767849-4"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-44767849-4');
</script></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">gdm</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.6.0-4</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/fitzLab-AL/gdm/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Assess Predictor Importance and Quantify Model Significance in a Fitted Generalized Dissimilarity Model.</h1>
      <small class="dont-index">Source: <a href="https://github.com/fitzLab-AL/gdm/blob/master/R/gdm.variable.importance.R" class="external-link"><code>R/gdm.variable.importance.R</code></a></small>
      <div class="d-none name"><code>gdm.varImp.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This function uses matrix permutation to perform model and
predictor significance testing and to estimate predictor importance in a
generalized dissimilarity model. The function can be run in parallel on
multicore machines to reduce computation time.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">gdm.varImp</span><span class="op">(</span><span class="va">spTable</span>, <span class="va">geo</span>, splines <span class="op">=</span> <span class="cn">NULL</span>, knots <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>predSelect <span class="op">=</span> <span class="cn">FALSE</span>, nPerm <span class="op">=</span> <span class="fl">50</span>, pValue<span class="op">=</span><span class="fl">0.05</span>, parallel <span class="op">=</span> <span class="cn">FALSE</span>, cores <span class="op">=</span> <span class="fl">2</span>,</span>
<span>sampleSites <span class="op">=</span> <span class="fl">1</span>, sampleSitePairs <span class="op">=</span> <span class="fl">1</span>, outFile <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-sptable">spTable<a class="anchor" aria-label="anchor" href="#arg-sptable"></a></dt>
<dd><p>A site-pair table, same as used to fit a <code><a href="gdm.html">gdm</a></code>.</p></dd>


<dt id="arg-geo">geo<a class="anchor" aria-label="anchor" href="#arg-geo"></a></dt>
<dd><p>Similar to the <code><a href="gdm.html">gdm</a></code> geo argument. The only
difference is that the geo argument does not have a default in this function.</p></dd>


<dt id="arg-splines">splines<a class="anchor" aria-label="anchor" href="#arg-splines"></a></dt>
<dd><p>Same as the <code><a href="gdm.html">gdm</a></code> splines argument. Note that
the current implementation requires that all predictors have the same number of
splines.</p></dd>


<dt id="arg-knots">knots<a class="anchor" aria-label="anchor" href="#arg-knots"></a></dt>
<dd><p>Same as the <code><a href="gdm.html">gdm</a></code> knots argument.</p></dd>


<dt id="arg-predselect">predSelect<a class="anchor" aria-label="anchor" href="#arg-predselect"></a></dt>
<dd><p>Set to TRUE to perform predictor selection using matrix
permutation and backward elimination. Default is FALSE. When predSelect = FALSE
results will be returned only for a model fit with all predictors.</p></dd>


<dt id="arg-nperm">nPerm<a class="anchor" aria-label="anchor" href="#arg-nperm"></a></dt>
<dd><p>Number of permutations to use to estimate p-values. Default is 50.</p></dd>


<dt id="arg-pvalue">pValue<a class="anchor" aria-label="anchor" href="#arg-pvalue"></a></dt>
<dd><p>The p-value to use for predictor selection / elimination. Default is 0.05.</p></dd>


<dt id="arg-parallel">parallel<a class="anchor" aria-label="anchor" href="#arg-parallel"></a></dt>
<dd><p>Whether or not to run the matrix permutations and model
fitting in parallel. Parallel processing is highly recommended when either
(i) the nPerms argument is large (&gt;100) or (ii) a large number of site-pairs
(and / or variables) are being used in model fitting (note computation demand
can be reduced using subsampling - see next arguments). The default is FALSE.</p></dd>


<dt id="arg-cores">cores<a class="anchor" aria-label="anchor" href="#arg-cores"></a></dt>
<dd><p>When the parallel argument is set to TRUE, the number of cores
to be registered for parallel processing. Must be &lt;= the number of cores in
the machine running the function. There is no benefit to setting the number of
cores greater than the number of predictors in the model.</p></dd>


<dt id="arg-samplesites">sampleSites<a class="anchor" aria-label="anchor" href="#arg-samplesites"></a></dt>
<dd><p>The fraction (0-1, though a value of 0 would be silly,
wouldn't it?) of <em>sites to retain</em> from the full site-pair table. If
less than 1, this argument will completely remove a fraction of sites such
that they are not used in the permutation routines.</p></dd>


<dt id="arg-samplesitepairs">sampleSitePairs<a class="anchor" aria-label="anchor" href="#arg-samplesitepairs"></a></dt>
<dd><p>The fraction (0-1) of <em>site-pairs (i.e., rows)
to retain</em> from the full site-pair table - in other words, all sites will
be used in the permutation routines (assuming sampleSites = 1), but not
all <em>site-pair combinations</em>. In the case where both the sampleSites
and the sampleSitePairs argument have values less than 1, sites first will
be removed using the sampleSites argument, followed by removal of site-pairs
using the sampleSitePairs argument. Note that the number of site-pairs
removed is based on the fraction of the resulting site-pair table after
sites have been removed, not on the size of the full site-pair table.</p></dd>


<dt id="arg-outfile">outFile<a class="anchor" aria-label="anchor" href="#arg-outfile"></a></dt>
<dd><p>An optional character string to write the object returned by
the function to disk as an .RData object (".RData" is not required as part
of the file name). The .RData object will contain a single list with the
name of "outObject". The default is NULL, meaning that no file will be written.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A list of four tables. The first table summarizes full model deviance,
percent deviance explained by the full model, the p-value of the full model,
and the number of permutations used to calculate the statistics for each
fitted model (i.e., the full model and each model with predictors removed in
succession during the backward elimination procedure if predSelect=T). The
remaining three tables summarize (1) predictor importance, (2) predictor
significance, and (3) the number of permutations used to calculate the
statistics for that model, which is provided because some GDMs may fail
to converge for some permutations / predictor combinations and you might want to
know how many permutations were used when calculating statistics. Or maybe you
don't, you decide.</p>
<p>Predictor importance is measured as the percent decrease in deviance explained
between the full model and the deviance explained by a model fit with that predictor
permuted. Significance is estimated using the bootstrapped p-value when the
predictor has been permuted. For most cases, the number of permutations will
equal the nPerm argument. However, the value may be less should any of the models
fit to them permuted tables fail to converge.</p>
<p>If predSelect=FALSE, the tables will have values only in the first column.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>To test model significance, first a model is fit using all predictors and
un-permuted environmental data. Any predictor for which the sum of the I-spline
coefficients sum to zero is preemptively removed. Next, the environmental data are permuted
nPerm times (by randomizing the order of the rows) and a GDM is fit to each
permuted table. Model significance is determined by comparing the deviance
explained by GDM fit to the un-permuted table to the distribution of deviance
explained values from GDM fit to the nPerm permuted tables. To assess predictor
significance, this process is repeated for each predictor individually (i.e.,
only the data for the predictor being tested is permuted rather than the entire
environmental table). Predictor importance is quantified as the percent change
in deviance explained between a model fit with and without that predictor permuted. If
predSelect=TRUE, this process continues by next permutating the site-pair
table nPerm times, but removing one predictor at a time and reassessing
predictor importance and significance. At each step, the least important
predictor is dropped (backward elimination) and the process continues until
all non-significant predictors are removed, with significance level being set
by the user and the pValue argument.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Ferrier S, Manion G, Elith J, Richardson, K (2007) Using
generalized dissimilarity modelling to analyse and predict patterns of
beta diversity in regional biodiversity assessment. <em>Diversity &amp;
Distributions</em> 13, 252-264.</p>
<p>Fitzpatrick, MC, Sanders NJ, Ferrier S, Longino JT, Weiser MD, and RR Dunn.
2011. Forecasting the Future of Biodiversity: a Test of Single- and
Multi-Species Models for Ants in North America. <em>Ecography</em> 34: 836-47.</p>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Matt Fitzpatrick and Karel Mokany</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co">##fit table environmental data</span></span></span>
<span class="r-in"><span><span class="co">##set up site-pair table using the southwest data set</span></span></span>
<span class="r-in"><span><span class="va">sppData</span> <span class="op">&lt;-</span> <span class="va">southwest</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">13</span>,<span class="fl">14</span><span class="op">)</span><span class="op">]</span></span></span>
<span class="r-in"><span><span class="va">envTab</span> <span class="op">&lt;-</span> <span class="va">southwest</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">southwest</span><span class="op">)</span><span class="op">)</span><span class="op">]</span></span></span>
<span class="r-in"><span><span class="va">sitePairTab</span> <span class="op">&lt;-</span> <span class="fu"><a href="formatsitepair.html">formatsitepair</a></span><span class="op">(</span><span class="va">sppData</span>, <span class="fl">2</span>, XColumn<span class="op">=</span><span class="st">"Long"</span>, YColumn<span class="op">=</span><span class="st">"Lat"</span>,</span></span>
<span class="r-in"><span>sppColumn<span class="op">=</span><span class="st">"species"</span>, siteColumn<span class="op">=</span><span class="st">"site"</span>, predData<span class="op">=</span><span class="va">envTab</span><span class="op">)</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>No abundance column was specified, so the biological data are assumed to be presences.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Aggregation function missing: defaulting to length</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## not run</span></span></span>
<span class="r-in"><span><span class="co">#modTest &lt;- gdm.varImp(sitePairTab, geo=T, nPerm=50, parallel=T, cores=10, predSelect=T)</span></span></span>
<span class="r-in"><span><span class="co">#barplot(sort(modTest$`Predictor Importance`[,1], decreasing=T))</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Matt Fitzpatrick, Karel Mokany, Glenn Manion, Diego Nieto-Lugilde, Simon Ferrier.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

