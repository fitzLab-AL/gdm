<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Fit a Generalized Dissimilarity Model to Tabular Site-Pair Data — gdm • gdm</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Fit a Generalized Dissimilarity Model to Tabular Site-Pair Data — gdm"><meta property="og:description" content="The gdm function is used to fit a generalized dissimilarity model to tabular
site-pair data formatted as follows using the formatsitepair
function: distance, weights, s1.xCoord, s1.yCoord, s2.xCoord, s2.yCoord,
s1.Pred1, s1.Pred2, ...,s1.PredN, s2.Pred1, s2.Pred2, ..., s2.PredN. The
distance column contains the response variable must be any ratio-based
dissimilarity (distance) measure between Site 1 and Site 2. The weights column
defines any weighting to be applied during fitting of the model. If equal
weighting is required, then all entries in this column should be set to 1.0
(default). The third and fourth columns, s1.xCoord and s1.yCoord, represent
the spatial coordinates of the first site in the site pair (s1). The fifth
and sixth columns, s2.xCoord and s2.yCoord, represent the coordinates of the
second site (s2). Note that the first six columns are REQUIRED, even if you
do not intend to use geographic distance as a predictor (in which case these
columns can be loaded with dummy data if the actual coordinates are
unknown - though that would be weird, no?). The next N*2 columns contain values
for N predictors for Site 1, followed by values for the same N predictors for
Site 2. 
The following is an example of a GDM input table header with three
environmental predictors (Temp, Rain, Bedrock): 
distance, weights, s1.xCoord, s1.yCoord, s2.xCoord, s2.yCoord, s1.Temp,
s1.Rain, s1.Bedrock, s2.Temp, s2.Rain, s2.Bedrock"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-44767849-4"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-44767849-4');
</script></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">gdm</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.6.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/fitzLab-AL/gdm/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Fit a Generalized Dissimilarity Model to Tabular Site-Pair Data</h1>
    <small class="dont-index">Source: <a href="https://github.com/fitzLab-AL/gdm/blob/HEAD/R/gdm.fit.R" class="external-link"><code>R/gdm.fit.R</code></a></small>
    <div class="hidden name"><code>gdm.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>The gdm function is used to fit a generalized dissimilarity model to tabular
site-pair data formatted as follows using the <code><a href="formatsitepair.html">formatsitepair</a></code>
function: distance, weights, s1.xCoord, s1.yCoord, s2.xCoord, s2.yCoord,
s1.Pred1, s1.Pred2, ...,s1.PredN, s2.Pred1, s2.Pred2, ..., s2.PredN. The
distance column contains the response variable must be any ratio-based
dissimilarity (distance) measure between Site 1 and Site 2. The weights column
defines any weighting to be applied during fitting of the model. If equal
weighting is required, then all entries in this column should be set to 1.0
(default). The third and fourth columns, s1.xCoord and s1.yCoord, represent
the spatial coordinates of the first site in the site pair (s1). The fifth
and sixth columns, s2.xCoord and s2.yCoord, represent the coordinates of the
second site (s2). Note that the first six columns are REQUIRED, even if you
do not intend to use geographic distance as a predictor (in which case these
columns can be loaded with dummy data if the actual coordinates are
unknown - though that would be weird, no?). The next N*2 columns contain values
for N predictors for Site 1, followed by values for the same N predictors for
Site 2. <br></p>
<p>The following is an example of a GDM input table header with three
environmental predictors (Temp, Rain, Bedrock): <br></p>
<p>distance, weights, s1.xCoord, s1.yCoord, s2.xCoord, s2.yCoord, s1.Temp,
s1.Rain, s1.Bedrock, s2.Temp, s2.Rain, s2.Bedrock</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">gdm</span><span class="op">(</span><span class="va">data</span>, geo<span class="op">=</span><span class="cn">FALSE</span>, splines<span class="op">=</span><span class="cn">NULL</span>, knots<span class="op">=</span><span class="cn">NULL</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>data</dt>
<dd><p>A data frame containing the site pairs to be used to fit the GDM
(obtained using the <code><a href="formatsitepair.html">formatsitepair</a></code> function). The
observed response data must be located in the first column. The weights to
be applied to each site pair must be located in the second column. If geo
is TRUE, then the s1.xCoord, s1.yCoord and s2.xCoord, s2.yCoord columns
will be used to calculate the geographic distance between site pairs for
inclusion as the geographic predictor term in the model. Site coordinates
ideally should be in a projected coordinate system (i.e., not longitude-latitude)
to ensure proper calculation of geographic distances. If geo is FALSE
(default), then the s1.xCoord, s1.yCoord, s2.xCoord and s2.yCoord data
columns must still be included, but are ignored in fitting the model.
Columns containing the predictor data for Site 1, and the predictor data
for Site 2, follow.</p></dd>


<dt>geo</dt>
<dd><p>Set to TRUE if geographic distance between sites is to be included
as a model term. Set to FALSE if geographic distance is to be omitted from
the model. Default is FALSE.</p></dd>


<dt>splines</dt>
<dd><p>An optional vector of the number of I-spline basis functions
to be used for each predictor in fitting the model. If supplied, it must
have the same length as the number of predictors (including geographic
distance if geo is TRUE). If this vector is not provided (splines=NULL),
then a default of 3 basis functions is used for all predictors.</p></dd>


<dt>knots</dt>
<dd><p>An optional vector of knots in  <em>units of the predictor
variables</em> to be used in the fitting process. If knots are supplied and
splines=NULL, then the knots argument must have the same length as the
number of predictors * n, where n is the number of knots (default=3). If both
knots and the number of splines are supplied, then the length of the knots
argument must be the same as the sum  of the values in the splines vector.
Note that the default values for knots when the default three I-spline basis
functions are 0 (minimum), 50 (median), and 100 (maximum) quantiles.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>gdm returns a gdm model object. The function
<code><a href="summary.gdm.html">summary.gdm</a></code> can be used to obtain or print a synopsis of the
results. A gdm model object is a list containing at least the following
components:</p>


<dl><dt>dataname</dt>
<dd><p>The name of the table used as the data argument
to the model.</p></dd>
 <dt>geo</dt>
<dd><p>Whether geographic distance was used as a
predictor in the model.</p></dd>
 <dt>gdmdeviance</dt>
<dd><p>The deviance of the fitted GDM
model.</p></dd>
 <dt>nulldeviance</dt>
<dd><p>The deviance of the null model.</p></dd>

<dt>explained</dt>
<dd><p>The percentage of null deviance explained by the fitted
GDM model.</p></dd>
 <dt>intercept</dt>
<dd><p>The fitted value for the intercept term in the
model.</p></dd>
 <dt>predictors</dt>
<dd><p>A list of the names of the predictors that were
used to fit the model, in order of the amount of turnover associated with
each predictor (based on the sum of the I-spline coefficients).</p></dd>
 <dt>coefficients</dt>
<dd><p>A list of the coefficients for
each spline for each of the predictors considered in model fitting.</p></dd>

<dt>knots</dt>
<dd><p>A vector of the knots derived from the x data (or user
defined), for each predictor.</p></dd>
 <dt>splines</dt>
<dd><p>A vector of the number of
I-spline basis functions used for each predictor.</p></dd>
 <dt>creationdate</dt>
<dd><p>The
date and time of model creation.</p></dd>
 <dt>observed</dt>
<dd><p>The observed response for
each site pair (from data column 1).</p></dd>
 <dt>predicted</dt>
<dd><p>The predicted
response for each site pair, from the fitted model (after applying the link
function).</p></dd>
 <dt>ecological</dt>
<dd><p>The linear predictor (ecological distance)
for each site pair, from the fitted model (before applying the link
function).</p></dd>
 
</dl></div>
    <div id="references">
    <h2>References</h2>
    <p>Ferrier S, Manion G, Elith J, Richardson, K (2007) Using
generalized dissimilarity modelling to analyse and predict patterns of beta
diversity in regional biodiversity assessment. <em>Diversity &amp;
Distributions</em> 13, 252-264.</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code><a href="formatsitepair.html">formatsitepair</a>, <a href="summary.gdm.html">summary.gdm</a>,
  <a href="plot.gdm.html">plot.gdm</a>, <a href="predict.gdm.html">predict.gdm</a>, <a href="gdm.transform.html">gdm.transform</a></code></p></div>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span> <span class="co">##fit table environmental data</span></span></span>
<span class="r-in"><span> <span class="co"># format site-pair table using the southwest data table</span></span></span>
<span class="r-in"><span> <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">southwest</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   species site    awcA  phTotal   sandA     shcA solumDepth     bio5     bio6</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1    spp1 1066 14.4725 546.1800 71.3250 178.8650   875.1725 31.43824 5.058823</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2    spp1 1026 16.2575 470.9950 68.8975 105.8400   928.4925 33.14412 4.852941</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3    spp1 1025 23.1375 459.7425 71.4700  88.3550   892.2275 32.84000 4.817143</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4    spp1 1026 16.2575 470.9950 68.8975 105.8400   928.4925 33.14412 4.852941</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5    spp1 1027 17.0175 489.3950 74.6775 147.2125   951.9050 33.17813 4.590625</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6    spp1 1047 17.3625 515.0825 75.7525 164.1875   981.4750 32.61579 4.676316</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      bio15 bio18    bio19       Lat     Long</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 40.38235     0 132.6471 -32.99425 118.7573</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 48.20588     0 140.2941 -32.04285 118.3495</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3 53.88571    43 145.0571 -31.99067 117.8260</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4 48.20588     0 140.2941 -32.04285 118.3495</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5 44.00000     0 135.6875 -32.09326 118.8736</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6 42.00000     0 134.0263 -32.54354 118.8157</span>
<span class="r-in"><span> <span class="va">sppData</span> <span class="op">&lt;-</span> <span class="va">southwest</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">13</span>,<span class="fl">14</span><span class="op">)</span><span class="op">]</span></span></span>
<span class="r-in"><span> <span class="va">envTab</span> <span class="op">&lt;-</span> <span class="va">southwest</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">southwest</span><span class="op">)</span><span class="op">)</span><span class="op">]</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span> <span class="va">sitePairTab</span> <span class="op">&lt;-</span> <span class="fu"><a href="formatsitepair.html">formatsitepair</a></span><span class="op">(</span><span class="va">sppData</span>, <span class="fl">2</span>, XColumn<span class="op">=</span><span class="st">"Long"</span>, YColumn<span class="op">=</span><span class="st">"Lat"</span>, sppColumn<span class="op">=</span><span class="st">"species"</span>,</span></span>
<span class="r-in"><span>                               siteColumn<span class="op">=</span><span class="st">"site"</span>, predData<span class="op">=</span><span class="va">envTab</span><span class="op">)</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>No abundance column was specified, so the biological data are assumed to be presences.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Aggregation function missing: defaulting to length</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span> <span class="co">##fit table GDM</span></span></span>
<span class="r-in"><span> <span class="va">gdmTabMod</span> <span class="op">&lt;-</span> <span class="fu">gdm</span><span class="op">(</span><span class="va">sitePairTab</span>, geo<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span> <span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">gdmTabMod</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] GDM Modelling Summary</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] Creation Date:  Mon Mar 25 19:52:01 2024</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] Name:  gdmTabMod</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] Data:  sitePairTab</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] Samples:  4371</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] Geographical distance used in model fitting?  TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] NULL Deviance:  651.914</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] GDM Deviance:  129.025</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] Percent Deviance Explained:  80.208</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] Intercept:  0.277</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] PREDICTOR ORDER BY SUM OF I-SPLINE COEFFICIENTS:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] Predictor 1: bio19</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] Splines: 3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] Min Knot: 114.394</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 50% Knot: 172.416</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] Max Knot: 554.771</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] Coefficient[1]: 0.941</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] Coefficient[2]: 0.868</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] Coefficient[3]: 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] Sum of coefficients for bio19: 1.809</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] Predictor 2: phTotal</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] Splines: 3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] Min Knot: 277.978</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 50% Knot: 584.609</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] Max Knot: 1860.37</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] Coefficient[1]: 1.127</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] Coefficient[2]: 0.23</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] Coefficient[3]: 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] Sum of coefficients for phTotal: 1.357</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] Predictor 3: bio5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] Splines: 3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] Min Knot: 25.571</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 50% Knot: 32.16</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] Max Knot: 36.188</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] Coefficient[1]: 0.127</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] Coefficient[2]: 0.453</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] Coefficient[3]: 0.114</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] Sum of coefficients for bio5: 0.694</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] Predictor 4: solumDepth</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] Splines: 3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] Min Knot: 705.02</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 50% Knot: 1017.628</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] Max Knot: 1247.705</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] Coefficient[1]: 0.682</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] Coefficient[2]: 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] Coefficient[3]: 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] Sum of coefficients for solumDepth: 0.682</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] Predictor 5: awcA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] Splines: 3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] Min Knot: 12.975</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 50% Knot: 22.186</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] Max Knot: 50.7</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] Coefficient[1]: 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] Coefficient[2]: 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] Coefficient[3]: 0.523</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] Sum of coefficients for awcA: 0.523</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] Predictor 6: Geographic</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] Splines: 3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] Min Knot: 0.452</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 50% Knot: 2.46</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] Max Knot: 6.532</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] Coefficient[1]: 0.014</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] Coefficient[2]: 0.372</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] Coefficient[3]: 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] Sum of coefficients for Geographic: 0.386</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] Predictor 7: sandA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] Splines: 3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] Min Knot: 56.697</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 50% Knot: 72.951</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] Max Knot: 83.993</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] Coefficient[1]: 0.092</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] Coefficient[2]: 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] Coefficient[3]: 0.139</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] Sum of coefficients for sandA: 0.231</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] Predictor 8: shcA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] Splines: 3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] Min Knot: 78.762</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 50% Knot: 179.351</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] Max Knot: 521.985</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] Coefficient[1]: 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] Coefficient[2]: 0.156</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] Coefficient[3]: 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] Sum of coefficients for shcA: 0.156</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] Predictor 9: bio6</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] Splines: 3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] Min Knot: 4.373</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 50% Knot: 5.509</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] Max Knot: 9.224</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] Coefficient[1]: 0.121</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] Coefficient[2]: 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] Coefficient[3]: 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] Sum of coefficients for bio6: 0.121</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] Predictor 10: bio15</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] Splines: 3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] Min Knot: 29.167</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 50% Knot: 55.008</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] Max Knot: 87.143</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] Coefficient[1]: 0.027</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] Coefficient[2]: 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] Coefficient[3]: 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] Sum of coefficients for bio15: 0.027</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] Predictor 11: bio18</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] Splines: 3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] Min Knot: 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 50% Knot: 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] Max Knot: 52</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] Coefficient[1]: 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] Coefficient[2]: 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] Coefficient[3]: 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] Sum of coefficients for bio18: 0</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span> <span class="co">##fit raster environmental data</span></span></span>
<span class="r-in"><span> <span class="co">##sets up site-pair table</span></span></span>
<span class="r-in"><span> <span class="va">rastFile</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"./extdata/swBioclims.grd"</span>, package<span class="op">=</span><span class="st">"gdm"</span><span class="op">)</span></span></span>
<span class="r-in"><span> <span class="va">envRast</span> <span class="op">&lt;-</span> <span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/rast.html" class="external-link">rast</a></span><span class="op">(</span><span class="va">rastFile</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span> <span class="co">##environmental raster data</span></span></span>
<span class="r-in"><span> <span class="va">sitePairRast</span> <span class="op">&lt;-</span> <span class="fu"><a href="formatsitepair.html">formatsitepair</a></span><span class="op">(</span><span class="va">sppData</span>, <span class="fl">2</span>, XColumn<span class="op">=</span><span class="st">"Long"</span>,</span></span>
<span class="r-in"><span>                                YColumn<span class="op">=</span><span class="st">"Lat"</span>, sppColumn<span class="op">=</span><span class="st">"species"</span>,</span></span>
<span class="r-in"><span>                                siteColumn<span class="op">=</span><span class="st">"site"</span>, predData<span class="op">=</span><span class="va">envRast</span><span class="op">)</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>No abundance column was specified, so the biological data are assumed to be presences.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Aggregation function missing: defaulting to length</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>When using rasters for environmental covariates (predictors), each site is assigned to the</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span>               raster cell in which the site is located. If more than one site occurs within the same raster cell,</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span>               the biological data of those sites are aggregated (more likely as raster resolution decreases).</span>
<span class="r-in"><span> <span class="co">##sometimes raster data returns NA in the site-pair table, these rows will</span></span></span>
<span class="r-in"><span> <span class="co">##have to be removed before fitting gdm</span></span></span>
<span class="r-in"><span> <span class="va">sitePairRast</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/na.fail.html" class="external-link">na.omit</a></span><span class="op">(</span><span class="va">sitePairRast</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span> <span class="co">##fit raster GDM</span></span></span>
<span class="r-in"><span> <span class="va">gdmRastMod</span> <span class="op">&lt;-</span> <span class="fu">gdm</span><span class="op">(</span><span class="va">sitePairRast</span>, geo<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span> <span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">gdmRastMod</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] GDM Modelling Summary</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] Creation Date:  Mon Mar 25 19:52:02 2024</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] Name:  gdmRastMod</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] Data:  sitePairRast</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] Samples:  4278</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] Geographical distance used in model fitting?  TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] NULL Deviance:  634.418</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] GDM Deviance:  190.801</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] Percent Deviance Explained:  69.925</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] Intercept:  0.395</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] PREDICTOR ORDER BY SUM OF I-SPLINE COEFFICIENTS:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] Predictor 1: bio19</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] Splines: 3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] Min Knot: 112</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 50% Knot: 166</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] Max Knot: 621</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] Coefficient[1]: 1.416</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] Coefficient[2]: 0.869</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] Coefficient[3]: 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] Sum of coefficients for bio19: 2.285</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] Predictor 2: bio5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] Splines: 3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] Min Knot: 257</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 50% Knot: 324</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] Max Knot: 362</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] Coefficient[1]: 0.025</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] Coefficient[2]: 0.514</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] Coefficient[3]: 0.39</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] Sum of coefficients for bio5: 0.929</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] Predictor 3: Geographic</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] Splines: 3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] Min Knot: 0.419</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 50% Knot: 2.451</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] Max Knot: 6.511</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] Coefficient[1]: 0.134</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] Coefficient[2]: 0.523</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] Coefficient[3]: 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] Sum of coefficients for Geographic: 0.657</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] Predictor 4: bio15</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] Splines: 3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] Min Knot: 28</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 50% Knot: 54</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] Max Knot: 88</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] Coefficient[1]: 0.191</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] Coefficient[2]: 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] Coefficient[3]: 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] Sum of coefficients for bio15: 0.191</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] Predictor 5: bio6</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] Splines: 3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] Min Knot: 41</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 50% Knot: 55</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] Max Knot: 95</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] Coefficient[1]: 0.07</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] Coefficient[2]: 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] Coefficient[3]: 0.013</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] Sum of coefficients for bio6: 0.083</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] Predictor 6: bio18</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] Splines: 3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] Min Knot: 29</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 50% Knot: 48</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] Max Knot: 89</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] Coefficient[1]: 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] Coefficient[2]: 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] Coefficient[3]: 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] Sum of coefficients for bio18: 0</span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Matt Fitzpatrick, Karel Mokany, Glenn Manion, Diego Nieto-Lugilde, Simon Ferrier.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer></div>

  


  

  </body></html>

